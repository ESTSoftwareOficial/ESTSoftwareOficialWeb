<header class="fixed inset-x-0 top-0 z-50 w-full flex justify-center pt-2 md:pt-6 px-2 md:px-0 font-poppins">
  <nav
    class="relative flex items-center justify-between px-4 md:px-6 py-3 transition-all duration-500 ease-out w-full"
    [ngStyle]="{
      'backdrop-filter': visible ? 'blur(10px)' : 'none',
      'background-color': visible ? 'rgba(0, 0, 0, 0.8)' : 'rgb(0, 0, 0)',
      'box-shadow': visible
        ? '0 0 24px rgba(255, 255, 255, 0.06), 0 1px 1px rgba(255, 255, 255, 0.05), 0 0 0 1px rgba(255, 255, 255, 0.04), 0 0 4px rgba(255, 255, 255, 0.08), 0 16px 68px rgba(255, 255, 255, 0.05), 0 1px 0 rgba(255, 255, 255, 0.1) inset'
        : 'none',
      'width': visible ? '60%' : '95%',
      'max-width': visible ? '800px' : '95%',
      'transform': visible ? 'translateY(20px)' : 'translateY(0)',
      'min-width': '280px',
      'border-radius': visible ? '9999px' : '20px'
    }">
    
    <a routerLink="/" (click)="handleNavClick()" class="relative z-20 flex items-center space-x-3 px-2 py-1 text-base font-semibold text-white">
      <img src="/assets/logo.svg" alt="ESTSoftware" width="40" height="40" class="w-8 h-8 md:w-10 md:h-10" />
      <span class="font-semibold text-white hidden sm:inline text-lg">ESTSoftware</span>
    </a>

    <div class="hidden lg:flex absolute inset-0 flex-1 items-center justify-center space-x-3">
      <a routerLink="/" class="relative px-5 py-2.5 rounded-full transition-all text-base font-medium" [ngClass]="isActive('/') ? 'text-white' : 'text-gray-400 hover:text-white'">
        <span *ngIf="isActive('/')" class="absolute inset-0 h-full w-full rounded-full bg-gray-800"></span>
        <span class="relative z-20">Inicio</span>
      </a>

      <a routerLink="/courses" class="relative px-5 py-2.5 rounded-full transition-all text-base font-medium" [ngClass]="isActive('/courses') ? 'text-white' : 'text-gray-400 hover:text-white'">
        <span *ngIf="isActive('/courses')" class="absolute inset-0 h-full w-full rounded-full bg-gray-800"></span>
        <span class="relative z-20">Cursos</span>
      </a>

      <a routerLink="/favorites" class="relative px-5 py-2.5 rounded-full transition-all text-base font-medium" [ngClass]="isActive('/favorites') ? 'text-white' : 'text-gray-400 hover:text-white'">
        <span *ngIf="isActive('/favorites')" class="absolute inset-0 h-full w-full rounded-full bg-gray-800"></span>
        <span class="relative z-20">Favoritos</span>
        <span *ngIf="favoritesCount > 0" class="absolute -top-1 -right-1 w-6 h-6 bg-red-500 text-white text-xs font-bold rounded-full flex items-center justify-center border-2 border-black z-30">
          {{ favoritesCount }}
        </span>
      </a>
    </div>

    <div class="flex items-center gap-3 relative z-20">
      <form (ngSubmit)="handleSearch($event)" class="hidden md:block">
        <div class="relative">
          <input type="text" [(ngModel)]="searchQuery" name="search" placeholder="Buscar..." aria-label="Buscar cursos" class="w-40 lg:w-56 px-5 py-2.5 pr-12 rounded-full bg-gray-800 text-base text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-[#22C55E] transition-all" />
          <svg class="absolute right-4 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400 pointer-events-none" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
          </svg>
        </div>
      </form>

      <a routerLink="/auth/login" class="hidden md:flex items-center gap-2 px-4 py-2 rounded-full text-gray-300 text-sm font-medium hover:text-white hover:bg-gray-800 transition-all">
        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
        </svg>
        <span>Login</span>
      </a>

      <button (click)="toggleMobileSearch()" class="md:hidden p-2.5 rounded-full hover:bg-gray-800 transition-colors" aria-label="Abrir búsqueda">
        <lucide-angular [img]="Search" [size]="22" class="text-gray-300"></lucide-angular>
      </button>

      <a routerLink="/favorites" (click)="handleNavClick()" class="lg:hidden relative p-2.5" aria-label="Ver favoritos">
        <lucide-angular [img]="Heart" [size]="26" [ngClass]="favoritesCount > 0 ? 'fill-red-500 text-red-500' : 'text-gray-300'"></lucide-angular>
        <span *ngIf="favoritesCount > 0" class="absolute -top-1 -right-1 w-6 h-6 bg-red-500 text-white text-xs font-bold rounded-full flex items-center justify-center border-2 border-black">
          {{ favoritesCount }}
        </span>
      </a>

      <button (click)="toggleMobileMenu()" class="lg:hidden p-2.5 rounded-full hover:bg-gray-800 transition-colors" [attr.aria-label]="mobileMenuOpen ? 'Cerrar menú' : 'Abrir menú'">
        <lucide-angular [img]="mobileMenuOpen ? X : Menu" [size]="26" class="text-gray-300"></lucide-angular>
      </button>
    </div>

    <div *ngIf="mobileSearchOpen" class="md:hidden absolute top-full left-0 right-0 mt-2 p-5 bg-black rounded-2xl shadow-lg border border-gray-800">
      <form (ngSubmit)="handleSearch($event)">
        <div class="relative">
          <input type="text" [(ngModel)]="searchQuery" name="mobileSearch" placeholder="Buscar cursos..." aria-label="Buscar cursos" class="w-full px-5 py-3.5 pr-12 rounded-full bg-gray-800 text-base text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-[#22C55E]" autofocus />
          <button type="submit" class="absolute right-4 top-1/2 -translate-y-1/2" aria-label="Buscar">
            <lucide-angular [img]="Search" [size]="22" class="text-gray-400"></lucide-angular>
          </button>
        </div>
      </form>
    </div>

    <div *ngIf="mobileMenuOpen" class="lg:hidden absolute top-full left-0 right-0 mt-2 p-5 bg-black rounded-2xl shadow-lg border border-gray-800">
      <nav class="flex flex-col space-y-3">
        <a routerLink="/" (click)="handleNavClick()" class="px-5 py-3.5 rounded-full text-base font-medium transition-all" [ngClass]="isActive('/') ? 'bg-gray-800 text-white' : 'text-gray-400 hover:bg-gray-800/50'">
          Inicio
        </a>
        <a routerLink="/courses" (click)="handleNavClick()" class="px-5 py-3.5 rounded-full text-base font-medium transition-all" [ngClass]="isActive('/courses') ? 'bg-gray-800 text-white' : 'text-gray-400 hover:bg-gray-800/50'">
          Cursos
        </a>
        <a routerLink="/favorites" (click)="handleNavClick()" class="px-5 py-3.5 rounded-full text-base font-medium transition-all flex items-center justify-between" [ngClass]="isActive('/favorites') ? 'bg-gray-800 text-white' : 'text-gray-400 hover:bg-gray-800/50'">
          <span>Favoritos</span>
          <span *ngIf="favoritesCount > 0" class="w-7 h-7 bg-red-500 text-white text-sm font-bold rounded-full flex items-center justify-center">
            {{ favoritesCount }}
          </span>
        </a>
        <a routerLink="/auth/login" (click)="handleNavClick()" class="px-5 py-3.5 rounded-full text-base font-medium transition-all flex items-center gap-2 text-gray-400 hover:bg-gray-800/50">
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
          </svg>
          <span>Login</span>
        </a>
      </nav>
    </div>
  </nav>
</header>